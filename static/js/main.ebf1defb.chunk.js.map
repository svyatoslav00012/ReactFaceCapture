{"version":3,"sources":["elems/CapturePhoto.js","elems/CheckPhoto.js","elems/Checkbox.js","utils/ImageDataMirrorer.js","utils/ImageMirrorer.js","utils/FaceDetector.js","utils/utils.js","utils/ImageCuter.js","App.js","index.js"],"names":["getTransformProperty","isMirror","scaleFactor","x","y","transformValue","MozTransform","WebkitTransform","OTransform","transform","CapturePhoto","fileInput","React","createRef","onChoosePhoto","_this","bind","Object","assertThisInitialized","click","videoCnstrts","this","props","videoConstraints","box","faceBox","rectWidth","viewport","height","rectHeight","videoMidX","width","videoMidY","minScale","Math","max","requiredScale","scale","relX","relY","leftVal","topVal","dx","dy","minTop","maxTop","minLeft","maxLeft","left","min","top","console","log","_this2","_this$calculateScaleL","calculateScaleLeftTop","drawBox","react_default","a","createElement","className","style","position","react_webcam_default","objectSpread","mirror","audio","imageSmoothing","ref","setRef","screenshotFormat","screenshotQuality","onUserMedia","type","onChange","handlePhotoChoose","input","onClick","onCapture","onNext","Component","CheckPhoto","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","src","imageSrc","onBack","onConfirm","Checkbox","label","checked","value","defaultProps","ImageDataMirrorer","imageData","arrayRGBA","pixelArray","forEach","pixel","push","r","g","b","pixelArrayToArrayOfRGBA","array2D","flatArray","i","length","apply","toConsumableArray","toFlatArray","reverse","mirror2DArrayByX","Array","slice","to2Darray","toPixelArray","data","ImageData","Uint8ClampedArray","utils_ImageMirrorer","ImageMirrorer","set","Set","canvas","document","ctx","getContext","img","Image","finishMirroring","webcam","passImageFunc","add","onload","getScreenshot","drawImage","currentImageData","getImageData","mirroredImageData","mirrorImage","putImageData","_iterator","Symbol","iterator","_iteratorNormalCompletion","_step","next","done","f","toDataURL","clear","utils_FaceDetector","FaceDetector","faceDetection","detectFace","getFullFaceDescription","MODEL_URL","faceapi","setFaceBox","callback","captureAndMirrorImage","then","fullDesc","detection","mtcnnParams","minFaceSize","res","selectedWidth","selectedHeight","mid","ResolutionsToCheck","right","findMaxResolution","_findMaxResolution","arguments","_callee","temporaryConstraints","regenerator_default","wrap","_context","prev","abrupt","floor","video","mandatory","minWidth","minHeight","maxWidth","maxHeight","navigator","mediaDevices","getUserMedia","stream","_didIteratorError","_iteratorError","undefined","getTracks","stop","err","return","catch","error","ImageCuter","ImageCropper","crop","frameToCrop","subImage","viewportWidth","documentElement","clientWidth","window","innerWidth","viewportHeight","clientHeight","innerHeight","App","state","handling","capturedFrame","frameRate","facingMode","componentDidMount","addEventListener","handleResize","setVideoConstraintsResolution","loadModels","handlingCurrentFrame","setState","setFaceBoxAndCalculateCapturedFrame","ReactGA","event","category","action","cropCapturedImage","cropImage","setImage","axios","post","setTimeout","onMirrorChange","e","target","frameHeight","frameWidth","estimatedFrameWidth","estimatedFrameHeight","frameX","frameY","isFarFromCurrent","resolution","abs","preventDefault","reader","FileReader","file","files","onloadend","result","readAsDataURL","checkPhoto","CheckPhoto_CheckPhoto","capturePhoto","CapturePhoto_CapturePhoto","assign","setLeftInfo","setTopInfo","display","justifyContent","Checkbox_Checkbox","ReactDOM","render","App_App","getElementById"],"mappings":"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","file":"static/js/main.ebf1defb.chunk.js","sourcesContent":["import React from 'react';\nimport Webcam from 'react-webcam';\n\nfunction getTransformProperty(isMirror, scaleFactor, x, y) {\n    const scaleValue = 'scale(' + (isMirror ? '-' : '') + scaleFactor + ', ' + scaleFactor + ')';\n    const translateValue = 'translate(' + x + 'px, ' + y + 'px)';\n    return getTransformStyleObject(scaleValue);// + ' ' + translateValue);\n}\n\n\nfunction getTransformStyleObject(transformValue) {\n    return {\n        MozTransform: transformValue,\n        WebkitTransform: transformValue,\n        OTransform: transformValue,\n        transform: transformValue,\n    };\n}\n\nexport default class CapturePhoto extends React.Component {\n\n    fileInput = React.createRef();\n    onChoosePhoto = this.onChoosePhoto.bind(this);\n\n    onChoosePhoto = () => {\n        this.fileInput.click();\n    };\n\n    calculateScaleLeftTop() {\n        const videoCnstrts = this.props.videoConstraints;\n        const box = this.props.faceBox;\n        const rectWidth = this.props.viewport.height * 0.45;\n        const rectHeight = this.props.viewport.height * 0.8;\n\n        const videoMidX = videoCnstrts.width / 2;\n        const videoMidY = videoCnstrts.height / 2;\n\n        const minScale = Math.max(rectWidth / videoCnstrts.width, rectHeight / videoCnstrts.height);\n        const requiredScale = rectWidth / box.width;\n        const scale = Math.max(minScale, requiredScale);\n\n        const relX = box.x - videoMidX;\n        const relY = box.y - videoMidY;\n\n        const leftVal = -videoCnstrts.width / 2 - relX * scale;\n        const topVal = -videoCnstrts.height / 2 - relY * scale + rectHeight / 6;\n\n        const dx = videoCnstrts.width / 2 * (scale - 1);\n        const dy = videoCnstrts.height / 2 * (scale - 1);\n\n\n        const minTop = -(videoCnstrts.height + dy - rectHeight);\n        const maxTop = dy;\n        const minLeft = -(videoCnstrts.width + dx - rectWidth);\n        const maxLeft = dx;\n\n        const left = Math.min(Math.max(leftVal, minLeft), maxLeft);\n        const top = Math.min(Math.max(topVal, minTop), maxTop);\n\n        console.log(scale + \" \" + left + \" \" + top);\n        console.log(\"faceBoxWidth = \" + box.width);\n        console.log();\n\n        return {scale, left, top};\n    }\n\n    render() {\n\n        const videoCnstrts = this.props.videoConstraints;\n        const box = this.props.faceBox;\n        const rectWidth = this.props.viewport.height * 0.45;\n        const rectHeight = this.props.viewport.height * 0.8;\n\n        const {scale, left, top} = this.calculateScaleLeftTop();\n\n        const drawBox = (\n            <div\n                className=\"face-box\"\n                style={{\n                    position: 'absolute',\n                    height: Math.min(box.height * scale - 6, rectHeight),\n                    width: Math.min(box.width * scale - 6, rectWidth),\n                    top: rectHeight / 6,\n                    left: 0,\n                }}\n            />\n        );\n\n        return (\n\n            <div className=\"main-div\">\n                <div className=\"typography\">Add photo</div>\n                <div className=\"webcam-div\">\n                    <Webcam\n                        style={{\n                            top: top,\n                            left: left,\n                            ...getTransformProperty(this.props.mirror, scale, left, -top),\n                        }}\n                        className=\"webcam-video\"\n                        audio={false}\n                        imageSmoothing={true}\n                        height={videoCnstrts.height}\n                        width={videoCnstrts.width}\n                        ref={this.props.setRef}\n                        screenshotFormat=\"image/jpeg\"\n                        screenshotQuality={1}\n                        videoConstraints={videoCnstrts}\n                        onUserMedia={this.props.onUserMedia}\n                    />\n                </div>\n                {drawBox}\n                <div className=\"oval-container\">\n                    <div className=\"oval\"/>\n                </div>\n                <div className=\"vl\"/>\n                <div className=\"hl\"/>\n\n                <input className=\"fileInput\"\n                       type=\"file\"\n                       onChange={this.props.handlePhotoChoose}\n                       ref={input => this.fileInput = input}/>\n                <button className=\"secondary-button photo-button\" onClick={this.onChoosePhoto}/>\n                <button className=\"main-button\" onClick={this.props.onCapture}>Pick photo</button>\n                <button className=\"next-button next-button\" onClick={this.props.onNext}/>\n            </div>\n        );\n    }\n}","import React from 'react';\n\nexport default class CheckPhoto extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.onNext = this.onNext.bind(this);\n    }\n\n    onNext() {\n        console.log(\"next\");\n    }\n\n    render() {\n        return (<div className=\"main-div\">\n            <div className=\"typography\">Confirm photo</div>\n            <img className=\"check-photo-img\" src={this.props.imageSrc}/>\n            <button className=\"secondary-button back-button\" onClick={this.props.onBack}/>\n            <button className=\"main-button\" onClick={this.props.onConfirm}>Confirm</button>\n            <button className=\"next-button next-button\" onClick={this.onNext}/>\n        </div>);\n    }\n\n}","import React from 'react';\nimport '../static/css/checkbox.css';\n\nexport default class Checkbox extends React.Component {\n\n    render() {\n        return (<label className=\"checkbox\">{this.props.label}\n            <input type=\"checkbox\" checked={this.props.value} onChange={this.props.onChange}/>\n            <span className=\"checkmark\"/>\n        </label>);\n    }\n}\n\nCheckbox.defaultProps = {\n    value: false,\n    label: ''\n};","class ImageProcessor {\n\n    mirrorImage(imageData) {\n        const pixelArray = toPixelArray(imageData.data);\n        const pixelArray2D = to2Darray(pixelArray, imageData.width, imageData.height);\n        const mirrored2DPixelArray = mirror2DArrayByX(pixelArray2D);\n        const flattenPixelArray = toFlatArray(mirrored2DPixelArray);\n        const arrayRGBA = pixelArrayToArrayOfRGBA(flattenPixelArray);\n        const mirroredImageData = new ImageData(new Uint8ClampedArray(arrayRGBA), imageData.width, imageData.height);\n        return mirroredImageData;\n    }\n\n}\n\nexport default new ImageProcessor();\n\nfunction toPixelArray(arrayRGBA) {\n    const pixelArray = new Array(arrayRGBA.length / 4);\n    for (let i = 0; i < arrayRGBA.length / 4; i++) {\n        pixelArray[i] = {\n            r: arrayRGBA[i * 4],\n            g: arrayRGBA[i * 4 + 1],\n            b: arrayRGBA[i * 4 + 2],\n            a: arrayRGBA[i * 4 + 3]\n        }\n    }\n    return pixelArray;\n}\n\nfunction to2Darray(flatArray, width, height) {\n    const array2D = new Array(height);\n    for (let i = 0; i < height; ++i)\n        array2D[i] = flatArray.slice(i * width, (i + 1) * width);\n    return array2D;\n}\n\nfunction mirror2DArrayByX(array2D) {\n    for (let i = 0; i < array2D.length; ++i)\n        array2D[i] = array2D[i].reverse();\n    return array2D;\n}\n\nfunction toFlatArray(array2D) {\n    const flatArray = [];\n    for (let i = 0; i < array2D.length; ++i)\n        flatArray.push(...array2D[i]);\n    return flatArray;\n}\n\nfunction pixelArrayToArrayOfRGBA(pixelArray) {\n    const arrayRGBA = [];\n    pixelArray.forEach(pixel => arrayRGBA.push(pixel.r, pixel.g, pixel.b, pixel.a));\n    return arrayRGBA;\n}","import ImageDataMirrorer from \"./ImageDataMirrorer\";\n\nclass ImageMirrorer {\n\n    constructor() {\n        this.set = new Set();\n        this.canvas = document.createElement('canvas');\n        this.ctx = this.canvas.getContext('2d');\n        this.img = new Image();\n        this.finishMirroring = this.finishMirroring.bind(this);\n    }\n\n    captureAndMirrorImage(webcam, passImageFunc) {\n        this.set.add(passImageFunc);\n        this.img.onload = this.finishMirroring;\n        this.img.src = webcam.getScreenshot();\n    }\n\n\n    async finishMirroring() {\n        this.canvas.width = this.img.width;\n        this.canvas.height = this.img.height;\n        this.ctx.drawImage(this.img, 0, 0);\n\n        const currentImageData = this.ctx.getImageData(this.img.x, this.img.y, this.img.width, this.img.height);\n        const mirroredImageData = ImageDataMirrorer.mirrorImage(currentImageData);\n        this.ctx.putImageData(mirroredImageData, 0, 0, 0, 0, currentImageData.width, currentImageData.height);\n\n        for (let f of this.set)\n            f(this.canvas.toDataURL());\n        this.set.clear();\n    }\n\n}\n\nexport default new ImageMirrorer();","import ImageMirrorer from \"./ImageMirrorer\";\nimport * as faceapi from \"face-api.js\";\n\nclass FaceDetector {\n\n    constructor() {\n        this.faceDetection = this.faceDetection.bind(this);\n        this.detectFace = this.detectFace.bind(this);\n        this.getFullFaceDescription = this.getFullFaceDescription.bind(this);\n    }\n\n    async loadModels() {\n        const MODEL_URL = './models';\n        await faceapi.loadMtcnnModel(MODEL_URL);\n        await faceapi.loadSsdMobilenetv1Model(MODEL_URL);\n        await faceapi.loadFaceLandmarkModel(MODEL_URL);\n        await faceapi.loadFaceRecognitionModel(MODEL_URL);\n    }\n\n    faceDetection(mirror, webcam, setFaceBox, callback) {\n        this.setFaceBox = setFaceBox;\n        this.callback = callback;\n            mirror ?\n                ImageMirrorer.captureAndMirrorImage(webcam, this.detectFace)\n                :\n                this.detectFace(webcam.getScreenshot());\n    }\n\n    async detectFace(src) {\n        await this.getFullFaceDescription(\n            src,\n        ).then(fullDesc => {\n            if (!!fullDesc && !!fullDesc.detection)\n                this.setFaceBox({\n                    x: fullDesc.detection.box.x,\n                    y: fullDesc.detection.box.y,\n                    width: fullDesc.detection.box.width,\n                    height: fullDesc.detection.box.height,\n                });\n            this.callback();\n        });\n    }\n\n    async getFullFaceDescription(src) {\n        let img = await faceapi.fetchImage(src);\n        const mtcnnParams = {\n            minFaceSize: 100\n        };\n        let res = await faceapi.mtcnn(img, mtcnnParams);\n        return res[0];\n    }\n\n}\n\nexport default new FaceDetector();","export function checkCameraExists() {\n    navigator.getMedia = (navigator.getUserMedia || // use the proper vendor prefix\n        navigator.webkitGetUserMedia ||\n        navigator.mozGetUserMedia ||\n        navigator.msGetUserMedia);\n\n    navigator.getMedia({video: true}, () => {\n    }, () => alert(\"camera isn't available\"));\n}\n\nconst ResolutionsToCheck = [\n    {width: 160, height: 120},\n    {width: 320, height: 180},\n    {width: 320, height: 240},\n    {width: 640, height: 360},\n    {width: 640, height: 480},\n    {width: 768, height: 576},\n    {width: 1024, height: 576},\n    {width: 1280, height: 720},\n    {width: 1280, height: 768},\n    {width: 1280, height: 800},\n    {width: 1280, height: 900},\n    {width: 1280, height: 1000},\n    {width: 1920, height: 1080},\n    {width: 1920, height: 1200},\n    {width: 2560, height: 1440},\n    {width: 3840, height: 2160},\n    {width: 4096, height: 2160}\n];\n\nlet left = 0;\nlet right = ResolutionsToCheck.length;\nlet selectedWidth;\nlet selectedHeight;\nlet mid;\n\nexport async function findMaxResolution() {\n    console.log(\"left = \", left, \", right = \", right);\n    if (left > right) {\n        console.log(\"Selected Height:Width = \", selectedWidth, \":\", selectedHeight);\n        return {height: selectedHeight, width: selectedWidth};\n    }\n\n    mid = Math.floor((left + right) / 2);\n\n    const temporaryConstraints = {\n        video: {\n            mandatory: {\n                minWidth: ResolutionsToCheck[mid].width,\n                minHeight: ResolutionsToCheck[mid].height,\n                maxWidth: ResolutionsToCheck[mid].width,\n                maxHeight: ResolutionsToCheck[mid].height\n            }\n        }\n    };\n\n    return navigator.mediaDevices.getUserMedia(temporaryConstraints)\n        .then(stream => {\n            console.log(\"Success for --> \", mid, \" \", ResolutionsToCheck[mid]);\n            selectedWidth = ResolutionsToCheck[mid].width;\n            selectedHeight = ResolutionsToCheck[mid].height;\n            left = mid + 1;\n            for (let track of stream.getTracks()) {\n                track.stop()\n            }\n            return findMaxResolution();\n        }).catch(error => {\n            console.log(\"Failed for --> \" + mid, \" \", ResolutionsToCheck[mid], \" \", error);\n            right = mid - 1;\n            return findMaxResolution();\n        });\n}","class ImageCropper {\n\n    constructor() {\n        this.set = new Set();\n        this.canvas = document.createElement('canvas');\n        this.ctx = this.canvas.getContext('2d');\n        this.img = new Image();\n        this.crop = this.crop.bind(this);\n    }\n\n    cropImage(imageSrc, frameToCrop, rectWidth, rectHeight, passImageFunc) {\n        this.set.add(passImageFunc);\n        this.subImage = frameToCrop;\n        this.rectWidth = rectWidth;\n        this.rectHeight = rectHeight;\n        this.img.onload = this.crop;\n        this.img.src = imageSrc;\n    }\n\n    crop() {\n        this.canvas.width = this.rectWidth;\n        this.canvas.height = this.rectHeight;\n        this.ctx.drawImage(this.img,\n            this.subImage.x,\n            this.subImage.y,\n            this.subImage.width,\n            this.subImage.height,\n            0,\n            0,\n            this.rectWidth,\n            this.rectHeight);\n        for (let f of this.set)\n            f(this.canvas.toDataURL());\n    }\n\n\n}\n\nexport default new ImageCropper();","import React from 'react';\nimport CapturePhoto from \"./elems/CapturePhoto\";\nimport axios from 'axios';\nimport './static/css/app.css';\nimport CheckPhoto from \"./elems/CheckPhoto\";\nimport Checkbox from \"./elems/Checkbox\";\nimport FaceDetector from \"./utils/FaceDetector\";\nimport {findMaxResolution} from \"./utils/utils\";\nimport ImageCuter from \"./utils/ImageCuter\";\nimport ImageMirrorer from \"./utils/ImageMirrorer\";\nimport ReactGA from 'react-ga';\n\nfunction initializeReactGA() {\n    ReactGA.initialize('UA-138960980-1');\n    ReactGA.pageview('/');\n}\n\nconst viewportWidth = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);\nconst viewportHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n\nexport default class App extends React.Component {\n\n    setRef = webcam => this.webcam = webcam;\n\n    webcam = null;\n    state = {\n        imageSrc: null,\n        mirror: true,\n        handling: true,\n        faceBox: {\n            x: 0,\n            y: 0,\n            width: viewportHeight * 0.45,\n            height: viewportHeight * 0.4,\n        },\n        //bounds of frame that we capture (according to face position and size)\n        capturedFrame: {\n            x: 0,\n            y: 0,\n            width: viewportHeight * 0.45,\n            height: viewportHeight * 0.8\n        },\n        videoConstraints: {\n            width: 640,\n            height: 480,\n            frameRate: 60,\n            facingMode: \"user\",\n        },\n        viewport: {\n            width: viewportWidth,\n            height: viewportHeight,\n        },\n    };\n\n    componentDidMount = () => {\n        window.addEventListener('resize', this.handleResize);\n        findMaxResolution().then(this.setVideoConstraintsResolution);\n        FaceDetector.loadModels()\n            .then(this.handlingCurrentFrame);\n    };\n\n    handleResize = () => {\n        this.setState({\n            viewport: {\n                width: Math.max(document.documentElement.clientWidth, window.innerWidth || 0),\n                height: Math.max(document.documentElement.clientHeight, window.innerHeight || 0),\n            },\n        });\n    };\n\n    handlingCurrentFrame = () => {\n        //console.log(\"enter handling\");\n        if (this.state.handling && !!this.webcam) {\n            FaceDetector.faceDetection(\n                this.state.mirror,\n                this.webcam,\n                this.setFaceBoxAndCalculateCapturedFrame,\n                this.handlingCurrentFrame\n            );\n            //   console.log(\"oo, handling!\");\n        }\n    };\n\n    onCapture = () => {\n        ReactGA.event({\n            category: 'User',\n            action: 'Capture'\n        });\n        if (this.state.mirror)\n            ImageMirrorer.captureAndMirrorImage(this.webcam, this.cropCapturedImage);\n        else this.cropCapturedImage(this.webcam.getScreenshot());\n    };\n\n    cropCapturedImage = (src) => {\n        const rectWidth = this.state.viewport.height * 0.45;\n        const rectHeight = this.state.viewport.height * 0.8;\n\n        ImageCuter.cropImage(\n            src,\n            this.state.capturedFrame,\n            rectWidth,\n            rectHeight,\n            this.setImage\n        );\n        this.setState({handling: false});\n    };\n\n    onConfirm = () => {\n        axios.post(\"/addImage\", this.state.imageSrc);\n        console.log(this.state.imageSrc);\n    };\n\n    onBack = () => {\n        this.setState({handling: true});\n        this.setImage(null);\n        setTimeout(this.handlingCurrentFrame, 3000);\n    };\n\n    onMirrorChange = (e) => {\n        this.setState({\n            mirror: e.target.checked\n        });\n    };\n\n    setFaceBoxAndCalculateCapturedFrame = (faceBox) => {\n\n        let frameHeight, frameWidth;\n\n        const estimatedFrameWidth = Math.min(this.state.videoConstraints.width, faceBox.width);\n        const estimatedFrameHeight = estimatedFrameWidth * 16 / 9;\n\n        //check for album-oriented(horizontal) web cameras, to keep image in shape of vertical rectangle\n        if (estimatedFrameHeight > this.state.videoConstraints.height) {\n            frameHeight = this.state.videoConstraints.height;\n            frameWidth = frameHeight / 16 * 9;\n        } else {\n            frameWidth = estimatedFrameWidth;\n            frameHeight = estimatedFrameHeight;\n        }\n\n        const frameX = Math.min(Math.max(0, faceBox.x), this.state.videoConstraints.width - faceBox.width);\n        const frameY = Math.min(Math.max(0, faceBox.y - frameHeight / 6), this.state.videoConstraints.height - frameHeight);\n\n\n        if (this.isFarFromCurrent(faceBox))\n            this.setState({\n                faceBox: faceBox,\n                capturedFrame: {\n                    x: frameX,\n                    y: frameY,\n                    width: frameWidth,\n                    height: frameHeight,\n                }\n            });\n    };\n\n    setVideoConstraintsResolution = (resolution) => {\n        this.setState({\n            videoConstraints: {\n                ...this.state.videoConstraints,\n                ...resolution\n            }\n        });\n    };\n\n    isFarFromCurrent = (faceBox) => {\n        const threshold = 20;\n        return Math.abs(faceBox.x - this.state.faceBox.x) > threshold ||\n            Math.abs(faceBox.y - this.state.faceBox.y) > threshold;\n    };\n\n    setImage = (src) => {\n        this.setState({\n            imageSrc: src\n        });\n    };\n\n    handlePhotoChoose = (e) => {\n        e.preventDefault();\n        let reader = new FileReader();\n        let file = e.target.files[0];\n        reader.onloadend = () => this.setImage(reader.result);\n        reader.readAsDataURL(file)\n    };\n\n    render() {\n\n        const checkPhoto = (<CheckPhoto videoConstraints={this.state.videoConstraints}\n                                        imageSrc={this.state.imageSrc}\n                                        onConfirm={this.onConfirm}\n                                        onBack={this.onBack}/>);\n\n        const capturePhoto = (<CapturePhoto webcam={this.webcam}\n                                            setRef={this.setRef}\n                                            {...this.state}\n                                            onUserMedia={this.handlingCurrentFrame()}\n                                            onCapture={this.onCapture}\n                                            onNext={this.handlingCurrentFrame}\n                                            handlePhotoChoose={this.handlePhotoChoose}\n                                            setLeftInfo={this.setLeftInfo}\n                                            setTopInfo={this.setTopInfo}/>);\n\n\n        return (<div style={{display: 'flex', width: '100%', justifyContent: 'center'}}>\n            <div>\n                {this.state.imageSrc ? checkPhoto : capturePhoto}\n                <h4 style={{width: viewportHeight * 0.45}}>If you don't see video stream, check if smth else using your\n                    webcamera.\n                    Also i'm working on browser compatibility)</h4>\n            </div>\n            <Checkbox value={this.state.mirror}\n                      onChange={this.onMirrorChange}\n                      label=\"mirror\"/>\n        </div>);\n    }\n\n}","import React from \"react\";\nimport ReactDOM from 'react-dom';\nimport App from \"./App\";\n\nReactDOM.render(<App/>, document.getElementById('root'));"],"sourceRoot":""}